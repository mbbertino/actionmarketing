var LoadedFile=Parse.Object.extend("Files"),LoadedFileCollection=Parse.Collection.extend({model:LoadedFile}),MainRouter=Backbone.Router.extend({routes:{"":"home",services:"services","services/:id":"services","client-login":"login","client-login/:user":"fileUpload",about:"contact",request:"request"},initialize:function(){},home:function(){new AppView},request:function(){new QuoteView},services:function(a){new ServicesView({serviceId:a})},login:function(){Parse.User.current()?window.router.navigate("/client-login/"+Parse.User.current().attributes.username,{trigger:!0}):new LoginView},fileUpload:function(){Parse.User.current()?new FilePortalView({model:Parse.User.current()}):window.router.navigate("/client-login",{trigger:!0})},contact:function(){new AboutView}});$(document).ready(function(){Parse.initialize("0NPDH9dF1j1bzL7Np4qyhwrEklrhRufzbFtSzcQ5","oS05oUW4w641gXfBU8HtgIgLNktILc5lgGfAFHHs"),window.router=new MainRouter,Backbone.history.start()});var AppView=Backbone.View.extend({renderedTemplate:_.template($("#appview-template").text()),events:{"click .js-all-services":"services","click .js-nav-one":"moveToOne","click .js-nav-two":"moveToTwo","click .js-nav-three":"moveToThree"},initialize:function(){$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border"),$(".link-home").addClass("link-border")},services:function(){window.router.navigate("/services",{trigger:!0}),$("html, body").animate({scrollTop:0},1e3)},moveToOne:function(){window.router.navigate("/services",{trigger:!0}),$("html, body").animate({scrollTop:0},1e3)},moveToTwo:function(){window.router.navigate("/services",{trigger:!0}),$(".js-nav-two").trigger("click")},moveToThree:function(){window.router.navigate("/services",{trigger:!0}),$(".js-nav-three").trigger("click")},render:function(){this.$el.html(this.renderedTemplate())}}),ServicesView=Backbone.View.extend({renderedTemplate:_.template($("#services-template").text()),events:{"click .js-nav-one":"moveToOne","click .js-nav-two":"moveToTwo","click .js-nav-three":"moveToThree","click .js-request-quote":"request"},initialize:function(){$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border"),$(".link-services").addClass("link-border"),doThisStuffOnScroll=function(){var a=document.documentElement.scrollTop||document.body.scrollTop;a>140?($(".docs-sidebar").removeClass("affix-top"),$(".docs-sidebar").addClass("affix")):($(".docs-sidebar").removeClass("affix"),$(".docs-sidebar").addClass("affix-top"))},window.onscroll=doThisStuffOnScroll},request:function(){window.router.navigate("/request",{trigger:!0})},moveToOne:function(){$("html, body").animate({scrollTop:0},1e3)},moveToTwo:function(){$("html, body").animate({scrollTop:$("#fill").offset().top-15},1e3)},moveToThree:function(){$("html, body").animate({scrollTop:$("#data").offset().top-15},1e3)},render:function(){this.$el.html(this.renderedTemplate())}}),LoginView=Backbone.View.extend({renderedTemplate:_.template($("#login-template").text()),events:{"click .js-login":"login","click .js-pw-reset":"reset","click .js-reset-submit":"resetRequest"},initialize:function(){$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border"),$(".link-client").addClass("link-border")},reset:function(){this.$(".js-email").toggleClass("hidden"),this.$(".js-username").toggleClass("hidden"),this.$(".js-password").toggleClass("hidden"),this.$(".js-login").toggleClass("hidden")},resetRequest:function(){Parse.User.requestPasswordReset(this.$(".js-email-val").val(),{success:function(){},error:function(){alert("Doesn't look like you are not a current user contact Action Marketing for further information")}})},login:function(){Parse.User.logIn(this.$(".js-username").val(),this.$(".js-password").val(),{success:function(a){window.router.navigate("/client-login/"+a.attributes.username,{trigger:!0})},error:function(){}})},render:function(){this.$el.html(this.renderedTemplate())}}),FilePortalView=Backbone.View.extend({className:"upload-wrapper col-xs-12",renderedTemplate:_.template($("#fileportal-template").text()),events:{"click .js-upload":"save","click .js-logout":"logout","click .js-create-view":"createUser","click .js-edit-delete":"editDeleteUser"},initialize:function(){$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border"),$(".link-client").addClass("link-border");var a=new Parse.Query("Files");a.find({success:function(a){_.defer(function(){{var a={valueNames:["name","date","fileName"]};new List("file-list",a)}}),_.each(a,function(a){new FileView({model:a})})}})},editDeleteUser:function(){new EditDeleteUserView},createUser:function(){new CreateUserView},logout:function(){Parse.User.logOut(),window.router.navigate("/client-login",{trigger:!0})},save:function(){var a=$("#file-upload-input")[0];if(a.files.length>0)var b=a.files[0],c=b.name,d=new Parse.File(c,b);d.save().then(function(){var a=new LoadedFile,b=(new Date).getTime();a.set("file",d),a.set("fileName",c),a.set("tStamp",b),a.set("clientName",Parse.User.current().attributes.clientname);var e=new Parse.ACL(Parse.User.current());e.setRoleReadAccess("Admin",!0),e.setRoleWriteAccess("Admin",!0),a.setACL(e),a.save(null,{success:function(){Parse.Cloud.run("sendUploadTemplate",{toClientName:Parse.User.current().attributes.clientname,fileName:c,toEmail:Parse.User.current().attributes.email,dateuploaded:moment(b).format("MM/DD/YYYY hh:mm A")},{success:function(){new FilePortalView({model:Parse.User.current()})},error:function(a){console.log(a)}})}})},function(){alert("file unable to upload")})},render:function(){this.$el.html(this.renderedTemplate())}}),FileView=Backbone.View.extend({tagName:"li",renderedTemplate:_.template($("#file-view-template").text()),events:{"click .js-destroy":"destroyFile"},initialize:function(){$(".file-list-box").append(this.el),this.render()},destroyFile:function(){var a=this;this.model.destroy({success:function(){a.remove()},error:function(){}})},render:function(){this.$el.html(this.renderedTemplate())}}),CreateUserView=Backbone.View.extend({className:"upload-wrapper col-xs-12",renderedTemplate:_.template($("#create-user-template").text()),events:{"click .js-create":"createUser","click .js-back":"back"},initialize:function(){$(".upload-section").html(this.el),this.render()},back:function(){Backbone.history.history.back()},createUser:function(){var a=this.$(".js-username").val(),b=this.$(".js-clientname").val(),c=this.$(".js-password").val(),d=this.$(".js-email").val();Parse.Cloud.run("createNewUser",{username:a,clientname:b,password:c,email:d},{success:function(){new FilePortalView({model:Parse.User.current()})},error:function(a){console.log(a)}})},render:function(){this.$el.html(this.renderedTemplate())}}),EditDeleteUserView=Backbone.View.extend({className:"upload-wrapper col-xs-12",renderedTemplate:_.template($("#edit-delete-user-template").text()),events:{"click .js-delete":"deleteUser","click .js-edit":"editUser","change .js-user-list":"updateInputValues","click .js-back":"back"},initialize:function(){$(".upload-section").html(this.el),this.render();var a=new Parse.Query(Parse.User);a.find({success:function(a){_.each(a,function(a){new UserListView({model:a})})}})},back:function(){Backbone.history.history.back()},updateInputValues:function(){var a=new Parse.Query(Parse.User);a.get(this.$(".js-user-list option:selected")[0].id,{success:function(a){console.log(a),this.$(".js-username").val(a.attributes.username),this.$(".js-clientname").val(a.attributes.clientname),this.$(".js-email").val(a.attributes.email),this.$(".js-id").val(a.id)},error:function(){response.error("Could not find user.")}})},deleteUser:function(){if(""!==this.$(".js-id").val()){var a=this.$(".js-id").val();Parse.Cloud.run("deleteUser",{badUserID:a},{success:function(){new FilePortalView({model:Parse.User.current()})},error:function(a){console.log(a)}})}},editUser:function(){if(""!==this.$(".js-id").val()){var a=this.$(".js-id").val(),b=this.$(".js-username").val(),c=this.$(".js-clientname").val(),d=this.$(".js-email").val();Parse.Cloud.run("editUser",{editUserID:a,username:b,clientname:c,email:d},{success:function(){new FilePortalView({model:Parse.User.current()})},error:function(a){console.log(a)}})}},render:function(){this.$el.html(this.renderedTemplate())}}),UserListView=Backbone.View.extend({tagName:"option",renderedTemplate:_.template($("#user-list-template").text()),events:{},initialize:function(){$(".js-user-list").append(this.el),this.render()},render:function(){this.$el.append(this.renderedTemplate()),this.$el.attr({id:this.model.id})}}),AboutView=Backbone.View.extend({className:"about-page",renderedTemplate:_.template($("#about-template").text()),events:{},initialize:function(){function a(){var a=new google.maps.LatLng(26.924099,-80.144593),c={scrollwheel:!1,zoom:14,center:a};b=new google.maps.Map(document.getElementById("map-canvas"),c);new google.maps.Marker({position:a,map:b,title:"Action Marketing"})}$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border"),$(".link-about").addClass("link-border");var b;a()},render:function(){this.$el.html(this.renderedTemplate())}}),QuoteView=Backbone.View.extend({className:"about-page",renderedTemplate:_.template($("#request-template").text()),events:{},initialize:function(){$(".content-wrapper").html(this.el),this.render(),$(".link").removeClass("link-border")},render:function(){this.$el.html(this.renderedTemplate())}});